import{m as k,g as J,a as u,q as K,z as U,s as E,w as $,c as a,t as r,b as s,G as W,n as C,H as z,F as Q,B as ss,x as o,u as H,p as V,j as es,o as n,I as Z,L as P,J as ts}from"./vendor-vue-BAWZmQqV.js";import{_ as ls,s as X}from"./index-CQTkKs-1.js";const os={key:0,class:"detail-container"},is={class:"main-layout"},as={class:"toolbar"},ns={class:"image-wrapper"},ds={class:"panzoom-container"},us=["src","alt"],rs={class:"filmstrip-container"},vs=["onClick"],cs=["src","onLoad"],fs={key:0,class:"map-section"},ms={class:"sidebar-content"},ps={class:"info-block"},hs={class:"info-list"},_s={class:"row"},xs=["title"],ks={class:"row"},gs={class:"row"},bs={class:"row"},ws=["title"],ys={class:"info-block"},Cs=["title"],Ts={key:0,class:"info-block"},Is={class:"params-grid"},Ms={class:"param-item"},zs={class:"p-val"},Ps={class:"param-item"},Ls={class:"p-val"},Ds={class:"param-item"},Bs={class:"p-val"},Rs={class:"param-item"},Ss={class:"p-val"},Ys={key:1,class:"info-block"},Es={class:"info-list"},$s={class:"row"},Hs=["title"],Vs={class:"row"},Zs=["title"],Xs={class:"row"},As={class:"row"},Ns=["title"],Os={key:2,class:"info-block"},js={class:"info-list"},Fs={class:"row"},qs={class:"row"},Gs=["title"],Js={class:"row"},Ks=["title"],Us={class:"row"},Ws=["title"],Qs={key:3,class:"info-block"},se={class:"info-list"},ee={class:"row"},te={class:"row"},le={class:"row"},oe=["title"],ie={__name:"PhotoDetail",setup(ae){const _=J(),T=U(),f=k(()=>X.photos||[]),t=k(()=>f.value.find(l=>l.id===_.params.id)),g=k(()=>f.value.findIndex(l=>l.id===_.params.id)),m=k(()=>g.value>0?f.value[g.value-1]:null),p=k(()=>g.value<f.value.length-1?f.value[g.value+1]:null),v=u(!0),L=()=>{v.value=!v.value,setTimeout(()=>{v.value&&d&&d.invalidateSize()},350)};K(()=>{X.initData(),window.addEventListener("keydown",D)});const c=l=>{l&&l!==_.params.id&&T.replace(`/photo/${l}`).catch(()=>{})},b=u(0),w=u(0),D=l=>{l.key==="ArrowLeft"&&m.value&&c(m.value.id),l.key==="ArrowRight"&&p.value&&c(p.value.id),l.key==="Escape"&&T.back(),(l.key==="i"||l.key==="I")&&L()},A=l=>{l.touches.length===1&&(b.value=l.changedTouches[0].screenX)},N=l=>{l.changedTouches.length===1&&(w.value=l.changedTouches[0].screenX,O())},O=()=>{Math.abs(w.value-b.value)>50&&(w.value<b.value-50&&p.value&&c(p.value.id),w.value>b.value+50&&m.value&&c(m.value.id))};E(()=>window.removeEventListener("keydown",D));const I=u(null);let h=null;const j=()=>{h&&(h.dispose(),h=null),I.value&&(h=ts(I.value,{maxZoom:5,minZoom:.5,bounds:!0,boundsPadding:.1,onTouch:()=>!1}))},M=u(null);let d=null;const B=()=>{var x,i;if(d&&(d.off(),d.remove(),d=null),!((i=(x=t.value)==null?void 0:x.exif)!=null&&i.gps)||!M.value)return;const{lat:l,lng:e}=t.value.exif.gps;d=P.map(M.value,{zoomControl:!1,attributionControl:!1,scrollWheelZoom:!1,dragging:!1,doubleClickZoom:!1}).setView([l,e],14),P.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",{maxZoom:19}).addTo(d),P.circleMarker([l,e],{color:"#fff",fillColor:"#1890ff",fillOpacity:1,radius:6,weight:2}).addTo(d)},R=u(null),S=u({}),F=()=>{const l=_.params.id,e=S.value[l];e&&R.value&&e.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})};$(()=>_.params.id,l=>{l&&Z(()=>{v.value&&B(),j(),F()})},{immediate:!0}),$(v,l=>{l&&Z(()=>{B()})}),E(()=>{h&&h.dispose()});const q=()=>T.back(),Y=u(new Set),G=l=>Y.value.add(l);return(l,e)=>{var x;return t.value?(n(),a("div",os,[s("div",{class:"blur-bg",style:W({backgroundImage:`url(${t.value.url})`})},null,4),e[31]||(e[31]=s("div",{class:"blur-overlay"},null,-1)),s("div",is,[s("div",{class:"preview-area",onTouchstartPassive:A,onTouchendPassive:N},[s("div",as,[s("button",{class:C(["icon-btn info-toggle",{active:v.value}]),onClick:L,title:"Toggle Info (i)"},[...e[2]||(e[2]=[s("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("circle",{cx:"12",cy:"12",r:"10"}),s("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),s("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})],-1)])],2),s("button",{class:"icon-btn close-btn",onClick:q,title:"Close (Esc)"},[...e[3]||(e[3]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),s("div",ns,[m.value?(n(),a("button",{key:0,class:"nav-arrow left desktop-only",onClick:e[0]||(e[0]=z(i=>c(m.value.id),["stop"]))},"â€¹ ")):r("",!0),s("div",ds,[s("img",{ref_key:"mainImgRef",ref:I,src:t.value.url,alt:t.value.name,class:"main-img"},null,8,us)]),p.value?(n(),a("button",{key:1,class:"nav-arrow right desktop-only",onClick:e[1]||(e[1]=z(i=>c(p.value.id),["stop"]))},"â€º ")):r("",!0)]),s("div",rs,[s("div",{class:"filmstrip",ref_key:"filmstripRef",ref:R},[(n(!0),a(Q,null,ss(f.value,i=>(n(),a("div",{key:i.id,class:C(["thumb-item",{active:i.id===t.value.id}]),ref_for:!0,ref:y=>{y&&(S.value[i.id]=y)},onClick:z(y=>c(i.id),["stop"])},[s("img",{src:i.url,loading:"lazy",class:C({visible:Y.value.has(i.id)}),onLoad:y=>G(i.id)},null,42,cs)],10,vs))),128))],512)])],32),s("aside",{class:C(["sidebar",{"sidebar-closed":!v.value}])},[e[30]||(e[30]=s("div",{class:"mobile-handle"},null,-1)),(x=t.value.exif)!=null&&x.gps?(n(),a("div",fs,[s("div",{ref_key:"mapContainer",ref:M,class:"map-view"},null,512),e[4]||(e[4]=s("div",{class:"map-overlay"},null,-1))])):r("",!0),s("div",ms,[s("div",ps,[e[9]||(e[9]=s("h3",{class:"block-title"},"åŸºæœ¬ä¿¡æ¯",-1)),s("dl",hs,[s("div",_s,[e[5]||(e[5]=s("dt",null,"æ–‡ä»¶å",-1)),s("dd",{title:t.value.name},o(t.value.name),9,xs)]),s("div",ks,[e[6]||(e[6]=s("dt",null,"å°ºå¯¸",-1)),s("dd",null,o(t.value.width)+" Ã— "+o(t.value.height),1)]),s("div",gs,[e[7]||(e[7]=s("dt",null,"å¤§å°",-1)),s("dd",null,o(t.value.size),1)]),s("div",bs,[e[8]||(e[8]=s("dt",null,"æ—¶é—´",-1)),s("dd",{title:H(V)(t.value.date).format("YYYY/MM/DD HH:mm:ss")},o(H(V)(t.value.date).format("YYYY/MM/DD HH:mm")),9,ws)])])]),s("div",ys,[s("div",{class:"album-tag-box",title:t.value.category},[e[10]||(e[10]=s("span",{class:"icon"},"ğŸ“‚",-1)),es(" "+o(t.value.category),1)],8,Cs)]),t.value.exif?(n(),a("div",Ts,[e[15]||(e[15]=s("h3",{class:"block-title"},"æ‹æ‘„å‚æ•°",-1)),s("div",Is,[s("div",Ms,[e[11]||(e[11]=s("span",{class:"p-label"},"ç„¦è·",-1)),s("span",zs,o(t.value.exif.focal),1)]),s("div",Ps,[e[12]||(e[12]=s("span",{class:"p-label"},"å…‰åœˆ",-1)),s("span",Ls,o(t.value.exif.fstop),1)]),s("div",Ds,[e[13]||(e[13]=s("span",{class:"p-label"},"å¿«é—¨",-1)),s("span",Bs,o(t.value.exif.shutter),1)]),s("div",Rs,[e[14]||(e[14]=s("span",{class:"p-label"},"ISO",-1)),s("span",Ss,o(t.value.exif.iso),1)])])])):r("",!0),t.value.exif?(n(),a("div",Ys,[e[20]||(e[20]=s("h3",{class:"block-title"},"è®¾å¤‡ä¿¡æ¯",-1)),s("dl",Es,[s("div",$s,[e[16]||(e[16]=s("dt",null,"ç›¸æœº",-1)),s("dd",{title:t.value.exif.make+" "+t.value.exif.model},o(t.value.exif.make)+" "+o(t.value.exif.model),9,Hs)]),s("div",Vs,[e[17]||(e[17]=s("dt",null,"é•œå¤´",-1)),s("dd",{title:t.value.exif.lens},o(t.value.exif.lens),9,Zs)]),s("div",Xs,[e[18]||(e[18]=s("dt",null,"35mm ç­‰æ•ˆ",-1)),s("dd",null,o(t.value.exif.focal35),1)]),s("div",As,[e[19]||(e[19]=s("dt",null,"è½¯ä»¶",-1)),s("dd",{title:t.value.exif.software},o(t.value.exif.software),9,Ns)])])])):r("",!0),t.value.exif?(n(),a("div",Os,[e[25]||(e[25]=s("h3",{class:"block-title"},"æ‹æ‘„æ¨¡å¼",-1)),s("dl",js,[s("div",Fs,[e[21]||(e[21]=s("dt",null,"ç™½å¹³è¡¡",-1)),s("dd",null,o(t.value.exif.whiteBalance),1)]),s("div",qs,[e[22]||(e[22]=s("dt",null,"æµ‹å…‰æ¨¡å¼",-1)),s("dd",{title:t.value.exif.meteringMode},o(t.value.exif.meteringMode),9,Gs)]),s("div",Js,[e[23]||(e[23]=s("dt",null,"æ›å…‰ç¨‹åº",-1)),s("dd",{title:t.value.exif.exposureProgram},o(t.value.exif.exposureProgram),9,Ks)]),s("div",Us,[e[24]||(e[24]=s("dt",null,"é—ªå…‰ç¯",-1)),s("dd",{title:t.value.exif.flash},o(t.value.exif.flash),9,Ws)])])])):r("",!0),t.value.exif?(n(),a("div",Qs,[e[29]||(e[29]=s("h3",{class:"block-title"},"æŠ€æœ¯å‚æ•°",-1)),s("dl",se,[s("div",ee,[e[26]||(e[26]=s("dt",null,"äº®åº¦",-1)),s("dd",null,o(t.value.exif.brightness),1)]),s("div",te,[e[27]||(e[27]=s("dt",null,"æ›å…‰è¡¥å¿",-1)),s("dd",null,o(t.value.exif.exposureBias),1)]),s("div",le,[e[28]||(e[28]=s("dt",null,"ä¼ æ„Ÿæ–¹å¼",-1)),s("dd",{title:t.value.exif.sensingMethod},o(t.value.exif.sensingMethod),9,oe)])])])):r("",!0)])],2)])])):r("",!0)}}},ue=ls(ie,[["__scopeId","data-v-6c92f2c5"]]);export{ue as default};
