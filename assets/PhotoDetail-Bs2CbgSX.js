const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor-vue-CWsiai-x.js","assets/vendor-vue-CIGW-MKW.css"])))=>i.map(i=>d[i]);
import{_ as se,s as O,a as Z}from"./index-BjyJhk9D.js";import{a as i,y as X,x as g,g as le,w as Y,G as H,B as te,c as n,q as m,b as e,M as oe,n as w,E as ae,N as L,k as j,j as ie,H as ne,F as de,D as ue,t as a,u as re,s as ve,o as d}from"./vendor-vue-CWsiai-x.js";const ce={key:0,class:"detail-container"},fe={class:"main-layout"},me={class:"toolbar"},pe={class:"image-wrapper"},he=["src","poster"],_e={key:2,class:"panzoom-container"},ye={key:0,class:"skeleton-loader main-img-skeleton"},ke=["src","alt"],ge={class:"filmstrip-container"},we=["onClick"],be=["src","onLoad"],xe={key:0,class:"map-section-wrapper"},Te={class:"sidebar-content"},Ce={class:"info-block"},Ie={class:"info-list"},Pe={class:"row"},De=["title"],Le={class:"row"},Ee={class:"row"},ze={class:"row"},Re={class:"info-block"},Se={class:"album-tag-box"},Ve={key:0,class:"info-block"},Be={class:"params-grid"},Me={class:"param-item"},$e={class:"p-val"},Ae={class:"param-item"},Ne={class:"p-val"},Oe={class:"param-item"},Ze={class:"p-val"},Xe={class:"param-item"},Ye={class:"p-val"},He={key:1,class:"info-block"},je={class:"info-list"},Fe={class:"row"},We={class:"row"},qe=["title"],Ge={class:"row"},Ke={class:"row"},Ue={__name:"PhotoDetail",setup(Je){const y=le(),E=ae(),b=(l,s,v={})=>{console.log(`[Analytics] ${l}`,{label:s,...v,timestamp:Date.now()})},F=i(Date.now());X(()=>{const l=Date.now()-F.value;b("PageLoad","PhotoDetail",{duration:l})});const p=g(()=>O.photos||[]),t=g(()=>p.value.find(l=>l.id===y.params.id)),x=g(()=>p.value.findIndex(l=>l.id===y.params.id)),h=g(()=>x.value>0?p.value[x.value-1]:null),_=g(()=>x.value<p.value.length-1?p.value[x.value+1]:null),T=i(!0);Y(()=>{var l;return(l=t.value)==null?void 0:l.id},()=>{T.value=!0});const C=i(!1),k=i(null),B=()=>{k.value&&(k.value.paused?(k.value.play(),C.value=!0,b("Interaction","PlayVideo")):(k.value.pause(),C.value=!1))},u=i(!0),z=i(null);let r=null;const R=async()=>{var o,f;if(r&&(r.off(),r.remove(),r=null),!((f=(o=t.value)==null?void 0:o.exif)!=null&&f.gps)||!z.value)return;const l=(await Z(async()=>{const{default:Q}=await import("./vendor-vue-CWsiai-x.js").then(ee=>ee.l);return{default:Q}},__vite__mapDeps([0,1]))).default,{lat:s,lng:v}=t.value.exif.gps;r=l.map(z.value,{zoomControl:!1,attributionControl:!1,scrollWheelZoom:!1,dragging:!1,doubleClickZoom:!1}).setView([s,v],13),l.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",{maxZoom:19}).addTo(r),l.circleMarker([s,v],{color:"#fff",fillColor:"#1890ff",fillOpacity:1,radius:8,weight:3}).addTo(r)},S=()=>{u.value=!u.value,b("Interaction","ToggleInfo",{state:u.value?"open":"closed"}),u.value&&setTimeout(()=>{r?r.invalidateSize():R()},400)},c=l=>{l&&l!==y.params.id&&(E.replace(`/photo/${l}`).catch(()=>{}),b("Interaction","SwitchPhoto"))},M=l=>{var s;l.key==="ArrowLeft"&&h.value&&c(h.value.id),l.key==="ArrowRight"&&_.value&&c(_.value.id),l.key==="Escape"&&E.back(),(l.key==="i"||l.key==="I")&&S(),l.key===" "&&((s=t.value)==null?void 0:s.type)==="video"&&(l.preventDefault(),B())};X(()=>{O.initData(),window.addEventListener("keydown",M),window.innerWidth<=900&&(u.value=!1),H(()=>{u.value&&R()})}),te(()=>window.removeEventListener("keydown",M));const V=i(null);let I=null;const W=async()=>{var l;if(I&&(I.dispose(),I=null),V.value&&((l=t.value)==null?void 0:l.type)!=="video"){const s=(await Z(async()=>{const{default:v}=await import("./vendor-vue-CWsiai-x.js").then(o=>o.i);return{default:v}},__vite__mapDeps([0,1]))).default;I=s(V.value,{maxZoom:5,minZoom:.5,bounds:!0,boundsPadding:.1,onTouch:()=>!1})}},$=i(null),A=i({}),q=()=>{const l=y.params.id,s=A.value[l];s&&$.value&&s.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})};Y(()=>y.params.id,l=>{l&&(C.value=!1,H(()=>{u.value&&R(),W(),q()}))},{immediate:!0});const G=()=>E.back(),N=i(new Set),K=l=>N.value.add(l),P=i(0),D=i(0),U=l=>{l.touches.length===1&&(P.value=l.changedTouches[0].screenX)},J=l=>{l.changedTouches.length===1&&(D.value=l.changedTouches[0].screenX,Math.abs(D.value-P.value)>50&&(D.value<P.value-50&&_.value&&c(_.value.id),D.value>P.value+50&&h.value&&c(h.value.id)))};return(l,s)=>{var v;return t.value?(d(),n("div",ce,[e("div",{class:"blur-bg",style:oe({backgroundImage:`url(${t.value.url})`})},null,4),s[26]||(s[26]=e("div",{class:"blur-overlay"},null,-1)),e("div",fe,[e("div",{class:"preview-area",onTouchstartPassive:U,onTouchendPassive:J},[e("div",me,[e("button",{class:w(["icon-btn info-toggle",{active:u.value}]),onClick:S,"aria-label":"Toggle Info"},[...s[3]||(s[3]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})],-1)])],2),e("button",{class:"icon-btn close-btn",onClick:G,"aria-label":"Close"},[...s[4]||(s[4]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),e("div",pe,[h.value?(d(),n("button",{key:0,class:"nav-arrow left desktop-only",onClick:s[0]||(s[0]=L(o=>c(h.value.id),["stop"])),"aria-label":"Previous"},[...s[5]||(s[5]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"15 18 9 12 15 6"})],-1)])])):m("",!0),t.value.type==="video"?(d(),n("div",{key:1,class:"panzoom-container video-container",onClick:L(B,["stop"])},[e("video",{ref_key:"videoRef",ref:k,src:t.value.url,poster:t.value.thumb,loop:"",muted:"",playsinline:"",class:"main-video"},null,8,he),e("div",{class:w(["live-badge",{active:C.value}])},[...s[6]||(s[6]=[e("div",{class:"live-icon"},[e("span")],-1),j(" LIVE ",-1)])],2)])):(d(),n("div",_e,[T.value?(d(),n("div",ye,[...s[7]||(s[7]=[e("div",{class:"spinner"},null,-1)])])):m("",!0),ie(e("img",{ref_key:"mainImgRef",ref:V,src:t.value.url,alt:t.value.name,class:"main-img",onLoad:s[1]||(s[1]=o=>T.value=!1)},null,40,ke),[[ne,!T.value]])])),_.value?(d(),n("button",{key:3,class:"nav-arrow right desktop-only",onClick:s[2]||(s[2]=L(o=>c(_.value.id),["stop"])),"aria-label":"Next"},[...s[8]||(s[8]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"9 18 15 12 9 6"})],-1)])])):m("",!0)]),e("div",ge,[e("div",{class:"filmstrip",ref_key:"filmstripRef",ref:$},[(d(!0),n(de,null,ue(p.value,o=>(d(),n("div",{key:o.id,class:w(["thumb-item",{active:o.id===t.value.id}]),ref_for:!0,ref:f=>{f&&(A.value[o.id]=f)},onClick:L(f=>c(o.id),["stop"])},[e("img",{src:o.url,loading:"lazy",class:w({visible:N.value.has(o.id)}),onLoad:f=>K(o.id)},null,42,be)],10,we))),128))],512)])],32),e("aside",{class:w(["sidebar",{"sidebar-closed":!u.value}])},[e("div",{class:"mobile-handle",onClick:S}),(v=t.value.exif)!=null&&v.gps?(d(),n("div",xe,[e("div",{ref_key:"mapContainer",ref:z,class:"map-view"},null,512),s[9]||(s[9]=e("div",{class:"map-overlay"},null,-1))])):m("",!0),e("div",Te,[e("div",Ce,[s[14]||(s[14]=e("h3",{class:"block-title"},"Âü∫Êú¨‰ø°ÊÅØ",-1)),e("dl",Ie,[e("div",Pe,[s[10]||(s[10]=e("dt",null,"Êñá‰ª∂Âêç",-1)),e("dd",{title:t.value.name},a(t.value.name),9,De)]),e("div",Le,[s[11]||(s[11]=e("dt",null,"Â∞∫ÂØ∏",-1)),e("dd",null,a(t.value.width)+" √ó "+a(t.value.height),1)]),e("div",Ee,[s[12]||(s[12]=e("dt",null,"Â§ßÂ∞è",-1)),e("dd",null,a(t.value.size),1)]),e("div",ze,[s[13]||(s[13]=e("dt",null,"Êó∂Èó¥",-1)),e("dd",null,a(re(ve)(t.value.date).format("YYYY/MM/DD HH:mm")),1)])])]),e("div",Re,[e("div",Se,[s[15]||(s[15]=e("span",{class:"icon"},"üìÇ",-1)),j(" "+a(t.value.category),1)])]),t.value.exif?(d(),n("div",Ve,[s[20]||(s[20]=e("h3",{class:"block-title"},"ÊãçÊëÑÂèÇÊï∞",-1)),e("div",Be,[e("div",Me,[s[16]||(s[16]=e("span",{class:"p-label"},"ÁÑ¶Ë∑ù",-1)),e("span",$e,a(t.value.exif.focal),1)]),e("div",Ae,[s[17]||(s[17]=e("span",{class:"p-label"},"ÂÖâÂúà",-1)),e("span",Ne,a(t.value.exif.fstop),1)]),e("div",Oe,[s[18]||(s[18]=e("span",{class:"p-label"},"Âø´Èó®",-1)),e("span",Ze,a(t.value.exif.shutter),1)]),e("div",Xe,[s[19]||(s[19]=e("span",{class:"p-label"},"ISO",-1)),e("span",Ye,a(t.value.exif.iso),1)])])])):m("",!0),t.value.exif?(d(),n("div",He,[s[25]||(s[25]=e("h3",{class:"block-title"},"ËÆæÂ§á‰ø°ÊÅØ",-1)),e("dl",je,[e("div",Fe,[s[21]||(s[21]=e("dt",null,"Áõ∏Êú∫",-1)),e("dd",null,a(t.value.exif.make)+" "+a(t.value.exif.model),1)]),e("div",We,[s[22]||(s[22]=e("dt",null,"ÈïúÂ§¥",-1)),e("dd",{title:t.value.exif.lens},a(t.value.exif.lens),9,qe)]),e("div",Ge,[s[23]||(s[23]=e("dt",null,"35mm",-1)),e("dd",null,a(t.value.exif.focal35),1)]),e("div",Ke,[s[24]||(s[24]=e("dt",null,"ËΩØ‰ª∂",-1)),e("dd",null,a(t.value.exif.software),1)])])])):m("",!0)])],2)])])):m("",!0)}}},ss=se(Ue,[["__scopeId","data-v-d39838c8"]]);export{ss as default};
