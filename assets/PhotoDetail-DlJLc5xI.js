import{m as y,g as G,a as u,q as J,s as $,w as H,c as n,t as r,b as s,G as K,n as C,z as U,H as z,F as W,B as Q,u as P,x as o,p as V,j as ss,o as a,I as Z,L,J as es}from"./vendor-vue-BAWZmQqV.js";import h from"./photos-BFzRSOCw.js";import{_ as ts}from"./index-C2d05Jq6.js";const ls={key:0,class:"detail-container"},os={class:"main-layout"},is={class:"toolbar"},ns={class:"image-wrapper"},as={class:"panzoom-container"},ds=["src","alt"],us={class:"filmstrip-container"},rs=["onClick"],vs=["src","onLoad"],cs={key:0,class:"map-section"},fs={class:"sidebar-content"},ms={class:"info-block"},ps={class:"info-list"},hs={class:"row"},_s=["title"],xs={class:"row"},ks={class:"row"},gs={class:"row"},bs=["title"],ws={class:"info-block"},ys=["title"],Cs={key:0,class:"info-block"},Ts={class:"params-grid"},Is={class:"param-item"},Ms={class:"p-val"},zs={class:"param-item"},Ps={class:"p-val"},Ls={class:"param-item"},Bs={class:"p-val"},Ds={class:"param-item"},Rs={class:"p-val"},Ss={key:1,class:"info-block"},Ys={class:"info-list"},Es={class:"row"},$s=["title"],Hs={class:"row"},Vs=["title"],Zs={class:"row"},Xs={class:"row"},As=["title"],Ns={key:2,class:"info-block"},Os={class:"info-list"},js={class:"row"},Fs={class:"row"},qs=["title"],Gs={class:"row"},Js=["title"],Ks={class:"row"},Us=["title"],Ws={key:3,class:"info-block"},Qs={class:"info-list"},se={class:"row"},ee={class:"row"},te={class:"row"},le=["title"],oe={__name:"PhotoDetail",setup(ie){const _=G(),T=U(),t=y(()=>h.find(l=>l.id===_.params.id)),k=y(()=>h.findIndex(l=>l.id===_.params.id)),f=y(()=>k.value>0?h[k.value-1]:null),m=y(()=>k.value<h.length-1?h[k.value+1]:null),v=u(!0),B=()=>{v.value=!v.value,setTimeout(()=>{v.value&&d&&d.invalidateSize()},350)},c=l=>{l&&l!==_.params.id&&T.replace(`/photo/${l}`).catch(()=>{})},g=u(0),b=u(0),D=l=>{l.key==="ArrowLeft"&&f.value&&c(f.value.id),l.key==="ArrowRight"&&m.value&&c(m.value.id),l.key==="Escape"&&T.back(),(l.key==="i"||l.key==="I")&&B()},X=l=>{l.touches.length===1&&(g.value=l.changedTouches[0].screenX)},A=l=>{l.changedTouches.length===1&&(b.value=l.changedTouches[0].screenX,N())},N=()=>{Math.abs(b.value-g.value)>50&&(b.value<g.value-50&&m.value&&c(m.value.id),b.value>g.value+50&&f.value&&c(f.value.id))};J(()=>window.addEventListener("keydown",D)),$(()=>window.removeEventListener("keydown",D));const I=u(null);let p=null;const O=()=>{p&&(p.dispose(),p=null),I.value&&(p=es(I.value,{maxZoom:5,minZoom:.5,bounds:!0,boundsPadding:.1,onTouch:()=>!1}))},M=u(null);let d=null;const R=()=>{var x,i;if(d&&(d.off(),d.remove(),d=null),!((i=(x=t.value)==null?void 0:x.exif)!=null&&i.gps)||!M.value)return;const{lat:l,lng:e}=t.value.exif.gps;d=L.map(M.value,{zoomControl:!1,attributionControl:!1,scrollWheelZoom:!1,dragging:!1,doubleClickZoom:!1}).setView([l,e],14),L.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",{maxZoom:19}).addTo(d),L.circleMarker([l,e],{color:"#fff",fillColor:"#1890ff",fillOpacity:1,radius:6,weight:2}).addTo(d)},S=u(null),Y=u({}),j=()=>{const l=_.params.id,e=Y.value[l];e&&S.value&&e.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})};H(()=>_.params.id,l=>{l&&Z(()=>{v.value&&R(),O(),j()})},{immediate:!0}),H(v,l=>{l&&Z(()=>{R()})}),$(()=>{p&&p.dispose()});const F=()=>T.back(),E=u(new Set),q=l=>E.value.add(l);return(l,e)=>{var x;return t.value?(a(),n("div",ls,[s("div",{class:"blur-bg",style:K({backgroundImage:`url(${t.value.url})`})},null,4),e[31]||(e[31]=s("div",{class:"blur-overlay"},null,-1)),s("div",os,[s("div",{class:"preview-area",onTouchstartPassive:X,onTouchendPassive:A},[s("div",is,[s("button",{class:C(["icon-btn info-toggle",{active:v.value}]),onClick:B,title:"Toggle Info (i)"},[...e[2]||(e[2]=[s("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("circle",{cx:"12",cy:"12",r:"10"}),s("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),s("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})],-1)])],2),s("button",{class:"icon-btn close-btn",onClick:F,title:"Close (Esc)"},[...e[3]||(e[3]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),s("div",ns,[f.value?(a(),n("button",{key:0,class:"nav-arrow left desktop-only",onClick:e[0]||(e[0]=z(i=>c(f.value.id),["stop"]))},"â€¹")):r("",!0),s("div",as,[s("img",{ref_key:"mainImgRef",ref:I,src:t.value.url,alt:t.value.name,class:"main-img"},null,8,ds)]),m.value?(a(),n("button",{key:1,class:"nav-arrow right desktop-only",onClick:e[1]||(e[1]=z(i=>c(m.value.id),["stop"]))},"â€º")):r("",!0)]),s("div",us,[s("div",{class:"filmstrip",ref_key:"filmstripRef",ref:S},[(a(!0),n(W,null,Q(P(h),i=>(a(),n("div",{key:i.id,class:C(["thumb-item",{active:i.id===t.value.id}]),ref_for:!0,ref:w=>{w&&(Y.value[i.id]=w)},onClick:z(w=>c(i.id),["stop"])},[s("img",{src:i.url,loading:"lazy",class:C({visible:E.value.has(i.id)}),onLoad:w=>q(i.id)},null,42,vs)],10,rs))),128))],512)])],32),s("aside",{class:C(["sidebar",{"sidebar-closed":!v.value}])},[e[30]||(e[30]=s("div",{class:"mobile-handle"},null,-1)),(x=t.value.exif)!=null&&x.gps?(a(),n("div",cs,[s("div",{ref_key:"mapContainer",ref:M,class:"map-view"},null,512),e[4]||(e[4]=s("div",{class:"map-overlay"},null,-1))])):r("",!0),s("div",fs,[s("div",ms,[e[9]||(e[9]=s("h3",{class:"block-title"},"åŸºæœ¬ä¿¡æ¯",-1)),s("dl",ps,[s("div",hs,[e[5]||(e[5]=s("dt",null,"æ–‡ä»¶å",-1)),s("dd",{title:t.value.name},o(t.value.name),9,_s)]),s("div",xs,[e[6]||(e[6]=s("dt",null,"å°ºå¯¸",-1)),s("dd",null,o(t.value.width)+" Ã— "+o(t.value.height),1)]),s("div",ks,[e[7]||(e[7]=s("dt",null,"å¤§å°",-1)),s("dd",null,o(t.value.size),1)]),s("div",gs,[e[8]||(e[8]=s("dt",null,"æ—¶é—´",-1)),s("dd",{title:P(V)(t.value.date).format("YYYY/MM/DD HH:mm:ss")},o(P(V)(t.value.date).format("YYYY/MM/DD HH:mm")),9,bs)])])]),s("div",ws,[s("div",{class:"album-tag-box",title:t.value.category},[e[10]||(e[10]=s("span",{class:"icon"},"ğŸ“‚",-1)),ss(" "+o(t.value.category),1)],8,ys)]),t.value.exif?(a(),n("div",Cs,[e[15]||(e[15]=s("h3",{class:"block-title"},"æ‹æ‘„å‚æ•°",-1)),s("div",Ts,[s("div",Is,[e[11]||(e[11]=s("span",{class:"p-label"},"ç„¦è·",-1)),s("span",Ms,o(t.value.exif.focal),1)]),s("div",zs,[e[12]||(e[12]=s("span",{class:"p-label"},"å…‰åœˆ",-1)),s("span",Ps,o(t.value.exif.fstop),1)]),s("div",Ls,[e[13]||(e[13]=s("span",{class:"p-label"},"å¿«é—¨",-1)),s("span",Bs,o(t.value.exif.shutter),1)]),s("div",Ds,[e[14]||(e[14]=s("span",{class:"p-label"},"ISO",-1)),s("span",Rs,o(t.value.exif.iso),1)])])])):r("",!0),t.value.exif?(a(),n("div",Ss,[e[20]||(e[20]=s("h3",{class:"block-title"},"è®¾å¤‡ä¿¡æ¯",-1)),s("dl",Ys,[s("div",Es,[e[16]||(e[16]=s("dt",null,"ç›¸æœº",-1)),s("dd",{title:t.value.exif.make+" "+t.value.exif.model},o(t.value.exif.make)+" "+o(t.value.exif.model),9,$s)]),s("div",Hs,[e[17]||(e[17]=s("dt",null,"é•œå¤´",-1)),s("dd",{title:t.value.exif.lens},o(t.value.exif.lens),9,Vs)]),s("div",Zs,[e[18]||(e[18]=s("dt",null,"35mm ç­‰æ•ˆ",-1)),s("dd",null,o(t.value.exif.focal35),1)]),s("div",Xs,[e[19]||(e[19]=s("dt",null,"è½¯ä»¶",-1)),s("dd",{title:t.value.exif.software},o(t.value.exif.software),9,As)])])])):r("",!0),t.value.exif?(a(),n("div",Ns,[e[25]||(e[25]=s("h3",{class:"block-title"},"æ‹æ‘„æ¨¡å¼",-1)),s("dl",Os,[s("div",js,[e[21]||(e[21]=s("dt",null,"ç™½å¹³è¡¡",-1)),s("dd",null,o(t.value.exif.whiteBalance),1)]),s("div",Fs,[e[22]||(e[22]=s("dt",null,"æµ‹å…‰æ¨¡å¼",-1)),s("dd",{title:t.value.exif.meteringMode},o(t.value.exif.meteringMode),9,qs)]),s("div",Gs,[e[23]||(e[23]=s("dt",null,"æ›å…‰ç¨‹åº",-1)),s("dd",{title:t.value.exif.exposureProgram},o(t.value.exif.exposureProgram),9,Js)]),s("div",Ks,[e[24]||(e[24]=s("dt",null,"é—ªå…‰ç¯",-1)),s("dd",{title:t.value.exif.flash},o(t.value.exif.flash),9,Us)])])])):r("",!0),t.value.exif?(a(),n("div",Ws,[e[29]||(e[29]=s("h3",{class:"block-title"},"æŠ€æœ¯å‚æ•°",-1)),s("dl",Qs,[s("div",se,[e[26]||(e[26]=s("dt",null,"äº®åº¦",-1)),s("dd",null,o(t.value.exif.brightness),1)]),s("div",ee,[e[27]||(e[27]=s("dt",null,"æ›å…‰è¡¥å¿",-1)),s("dd",null,o(t.value.exif.exposureBias),1)]),s("div",te,[e[28]||(e[28]=s("dt",null,"ä¼ æ„Ÿæ–¹å¼",-1)),s("dd",{title:t.value.exif.sensingMethod},o(t.value.exif.sensingMethod),9,le)])])])):r("",!0)])],2)])])):r("",!0)}}},ue=ts(oe,[["__scopeId","data-v-0821261a"]]);export{ue as default};
